<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ¯ BOMBA BET | Real Sports</title>

<script src="https://cdn.tailwindcss.com"></script>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

<style>
body{background:#0a0a0f;color:#e4e4e7;font-family:Inter,sans-serif}
.glass{background:rgba(255,255,255,.05);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,.08)}
.loader{animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>

<body>
<div id="root"></div>

<script>
// ================= CONFIG =================
firebase.initializeApp({
  apiKey: "AIzaSyAzXGyOUDeok9zHZ3Lrqplb9I4u2xxGsPY",
  authDomain: "bombabet26.firebaseapp.com"
});

const auth = firebase.auth();

const API_KEY = "e6b4654b35e54995aeb2834ae3f81bcb";
const PROXY = url => `https://corsproxy.io/?${encodeURIComponent(url)}`;

// ================= STATE =================
let state = {
  user:null,
  loading:false,
  sport:'football',
  football:[],
  basketball:[],
  tennis:[]
};

// ================= AUTH =================
auth.onAuthStateChanged(user=>{
  state.user=user;
  render();
  if(user){
    fetchFootball();
    fetchBasket();
    fetchTennis();
  }
});

function login(){
  auth.signInWithPopup(new firebase.auth.GoogleAuthProvider());
}
function logout(){
  auth.signOut();
}

// ================= DATE UTILS =================
function today(){
  return new Date().toISOString().split("T")[0];
}
function plusDays(d){
  const x=new Date();x.setDate(x.getDate()+d);
  return x.toISOString().split("T")[0];
}

// ================= FOOTBALL =================
async function fetchFootball(){
  const url = `
https://v3.football.api-sports.io/fixtures
?season=2025
&from=${today()}
&to=${plusDays(7)}
`.replace(/\s+/g,'');

  const r = await fetch(PROXY(url),{headers:{'x-apisports-key':API_KEY}});
  const j = await r.json();

  state.football = (j.response||[])
    .filter(m=>['NS','TBD','LIVE'].includes(m.fixture.status.short))
    .slice(0,20);

  render();
}

// ================= BASKET =================
async function fetchBasket(){
  const url = `
https://v3.basketball.api-sports.io/games
?date=${today()}
`.replace(/\s+/g,'');

  const r = await fetch(PROXY(url),{headers:{'x-apisports-key':API_KEY}});
  const j = await r.json();

  state.basketball = (j.response||[])
    .filter(g=>['NS','LIVE'].includes(g.status.short))
    .slice(0,20);

  render();
}

// ================= TENNIS =================
async function fetchTennis(){
  const url = `
https://v3.tennis.api-sports.io/fixtures
?from=${today()}
&to=${plusDays(7)}
`.replace(/\s+/g,'');

  const r = await fetch(PROXY(url),{headers:{'x-apisports-key':API_KEY}});
  const j = await r.json();

  state.tennis = (j.response||[])
    .filter(m=>['NS','LIVE'].includes(m.status.short))
    .slice(0,20);

  render();
}

// ================= RENDER =================
function render(){
  const root=document.getElementById("root");

  if(!state.user){
    root.innerHTML=`
    <div class="min-h-screen flex items-center justify-center">
      <button onclick="login()" class="glass px-6 py-4 rounded-xl font-bold">
        ğŸ” Login Google
      </button>
    </div>`;
    return;
  }

  root.innerHTML=`
  <div class="max-w-lg mx-auto p-3 space-y-3">

    <div class="flex justify-between items-center">
      <h1 class="font-black">ğŸ¯ BOMBA BET</h1>
      <button onclick="logout()">ğŸšª</button>
    </div>

    <div class="flex gap-1">
      ${['football','basketball','tennis'].map(s=>`
        <button onclick="state.sport='${s}';render()"
          class="flex-1 py-2 rounded ${state.sport===s?'bg-white/20':'glass'}">
          ${s==='football'?'âš½':s==='basketball'?'ğŸ€':'ğŸ¾'}
        </button>
      `).join('')}
    </div>

    ${renderMatches()}

  </div>`;
}

function renderMatches(){
  const list = state[state.sport];
  if(!list || list.length===0){
    return `<div class="glass p-4 text-center text-gray-400">Nessuna partita</div>`;
  }

  return `
  <div class="space-y-2">
    ${list.map(m=>{
      if(state.sport==='football'){
        return matchBox(
          m.teams.home.name,
          m.teams.away.name,
          m.fixture.date
        );
      }
      if(state.sport==='basketball'){
        return matchBox(
          m.teams.home.name,
          m.teams.away.name,
          m.date
        );
      }
      return matchBox(
        m.players[0].player.name,
        m.players[1].player.name,
        m.date
      );
    }).join('')}
  </div>`;
}

function matchBox(a,b,d){
  const x=new Date(d);
  return `
  <div class="glass p-3 rounded-lg">
    <p class="font-bold text-sm">${a} vs ${b}</p>
    <p class="text-xs text-gray-400">
      ${x.toLocaleDateString()} ${x.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'})}
    </p>
  </div>`;
}
</script>
</body>
</html>
